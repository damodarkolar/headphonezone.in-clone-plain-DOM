<!DOCTYPE html>
<html lang="en">
<head>
    <title>payment page</title>
    <link rel="stylesheet" href="./paymentPage.css">
</head>
<body>
    <div id="container">
        <div id="CardDetails">
            <div id="cardDetailsDiv">
                <h1 id="paymentAmount"></h1>
                <form action="" id="paymentPage">
                    <input type="number" placeholder="Enter Card Details" id="cardNumber">
                    <div id="cardMonthYear">
                        <select name="" id="cardMonth">
                            <option value="select">select</option>
                            <option value="01"> 01</option>   
                            <option value="02"> 01</option>   
                            <option value="03"> 01</option>   
                            <option value="04"> 01</option> 
                            <option value="05"> 01</option>   
                            <option value="06"> 01</option> 
                            <option value="07"> 01</option>   
                            <option value="08"> 01</option> 
                            <option value="09"> 01</option>   
                            <option value="10"> 01</option>       
                            <option value="11"> 01</option>   
                            <option value="12"> 01</option>  
                        </select>
                        <input type="number" placeholder="YYYY" id="cardYear">
                        <input type="number" placeholder="CVV" id="cardCvv">
                    </div>                    
                    <input type="text" placeholder="Enter card holder name" id="cardName">
                    <input type="submit" id="submitbutton">
                </form>          
            </div>               
        </div>
        <div id="cartDetails">
            <div id="products">
                
            </div>
            <div id="promoCode">
                <form action="" id="promoForm">
                    <input type="text" placeholder="Gift card or Dicount code"id="inputPromo" style="border-radius:2px; width: 300px;height: 40px;">
                    <input type="submit" value="Apply" id="applybutton" style="color:white;border-radius: 10px;background-color: rgb(237, 231, 231);width: 80px; height: 50px; font-size: large;">
                </form>
            </div>
            <div id="amountDetails">
                <div>
                    <p>Subtotal</p>
                <p id="subTootalTag"></p>
                </div>
                <div>
                    <p>Shipping</p>
                    <p>Free</p>
                </div>
            </div>
            <div id="totalDetails">
                <p> Total</p>
                <p id="totalTag"></p>
            </div>
        </div>
    </div>    
</body>
<script>
    window.addEventListener("load",checkOutPageCreator)

    var cartArr=JSON.parse(localStorage.getItem("headphoneCartItems")) || [];   
    var total=localStorage.getItem("headphoneCheckOutTotal");
    var productsDiv=document.querySelector("#products");

    if(cartArr.length==1){       
        productsDiv.setAttribute("style","height:77px");
    }else if(cartArr.length==2){
        productsDiv.setAttribute("style","height:154px");
    }else{
        productsDiv.setAttribute("style","height:235px");
    }

    function checkOutPageCreator(){
        subtotalTag();
        totalTag();
        productsWindow();
    }

    function subtotalTag(){
        var subTag=document.querySelector("#subTootalTag");
        subTag.innerText=total;
    }

    function totalTag(){
        var totTag=document.querySelector("#totalTag");
        totTag.innerText=total;
    }

    function productsWindow(){
        cartArr.forEach(element => {
            var product=document.createElement("div");
            product.setAttribute("class","product");
            
            var imageDiv=document.createElement("div");
            imageDiv.setAttribute("class","imageDiv");
            var imageUrllink=element.imageUrl;
            var imageElement=document.createElement("img");
            imageElement.setAttribute("class","image");
            imageElement.src=imageUrllink;
            var qntElement=document.createElement("div");
            qntElement.setAttribute("class","qntOnImage");
            qntElement.innerText=element.quantity;
        
            imageDiv.append(imageElement,qntElement);
            


            var detailsDiv=document.createElement("div");
            detailsDiv.setAttribute("class","detailsDiv");
            var nameElement=document.createElement("h5");
            nameElement.setAttribute("class","nameElement");
            nameElement.innerText=element.productName;
            var colorElement=document.createElement("p");
            colorElement.setAttribute("class","colorElement");
            colorElement.innerText=element. productColor;
            detailsDiv.append(nameElement,colorElement);

            var priceDiv=document.createElement("div");
            priceDiv.setAttribute("class", "priceDiv");
            var price=((parseInt(element.discountPrice))*(parseInt(element.quantity)));
            var priceElement=document.createElement("h5");
            priceElement.setAttribute("class","priceElement");
            priceElement.innerText="â‚¹"+price+".00";
            priceDiv.append(priceElement);

            product.append(imageDiv,detailsDiv,priceDiv);
            
            document.querySelector("#products").append(product);
        });
    }
    document.querySelector("#paymentPage").addEventListener("submit",cardValidate);
var totalAmount=parseInt(localStorage.getItem("headphoneCheckOutTotal"));
var totalAmountTag=document.querySelector("#paymentAmount");
totalAmountTag.innerText="To pay the Amount "+totalAmount;

    function cardValidate(){
        event.preventDefault();
        var cardNumber=document.querySelector("#cardNumber").value;
        var cardMonth=document.querySelector("#cardMonth").value;
        var cardYear=document.querySelector("#cardYear").value;
        var cardCvv=document.querySelector("#cardCvv").value;
        var cardName=document.querySelector("#cardName").value;
        
       if(cardNumber.length==16 && cardMonth!="select" && cardYear.length==4 && parseInt(cardYear)>=2022 && cardCvv.length==3 && cardName!==""){
           alert("Your order is successfully placed continue to shop");
           window.location.href="./products.html";
       }
       else{
           alert("Error");
       }
    }
</script>

</html>